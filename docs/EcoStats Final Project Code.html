<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ecostats-final-project-code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="EcoStats Final Project Code_files/libs/clipboard/clipboard.min.js"></script>
<script src="EcoStats Final Project Code_files/libs/quarto-html/quarto.js"></script>
<script src="EcoStats Final Project Code_files/libs/quarto-html/popper.min.js"></script>
<script src="EcoStats Final Project Code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="EcoStats Final Project Code_files/libs/quarto-html/anchor.min.js"></script>
<link href="EcoStats Final Project Code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="EcoStats Final Project Code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="EcoStats Final Project Code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="EcoStats Final Project Code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="EcoStats Final Project Code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="ecostats-final-project" class="level1">
<h1>EcoStats Final Project</h1>
<p>Name: Josie Pilchik <br> Date: 5/15/2024</p>
<p>Response variable: <br> -distMoved <br></p>
<p>Potential explanatory variables (to be explored through data exploration): <br> -year <br> -month <br> -section (the section the fish is found in at each of the sampling events) <br> -observedLength <br> -observedWeight <br> -meanTemperature <br> -meanFlowByRiver</p>
<p>Random effects variables: <br> -tag</p>
<section id="data-loading" class="level2">
<h2 class="anchored" data-anchor-id="data-loading">Data loading</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages needed later</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MuMIn'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:AICcmodavg':

    AICc, DIC, importance</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lme4'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:AICcmodavg':

    checkConv</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::expand() masks Matrix::expand()
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
✖ tidyr::pack()   masks Matrix::pack()
✖ dplyr::recode() masks car::recode()
✖ purrr::some()   masks car::some()
✖ tidyr::unpack() masks Matrix::unpack()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load the dataset with all of the wanding and environmental data into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cdWB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'/Users/jpilchik/OneDrive - DOI/Documents/Wanding_Data/data/cdWB_All.csv'</span>, <span class="at">header=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Filter the dataset to include only the Obear brook observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#specify team names to keep</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>river_name <span class="ot">&lt;-</span> <span class="st">'wb obear'</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#select all rows where team is in list of team names to keep</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>obear_All <span class="ot">&lt;-</span> cdWB <span class="sc">%&gt;%</span> <span class="fu">filter</span>(river <span class="sc">%in%</span> river_name)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(obear_All)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X        tag       detectionDate sampleName sampleNumber    river section
1  1 00088cbed0 2013-03-25 04:00:00         84           73 wb obear       7
2  8 00088cbed7 2014-09-17 04:00:00         90           79 wb obear       3
3  9 00088cbed7 2014-12-01 05:00:00         91           80 wb obear       3
4 16 00088cbedd 2012-09-21 04:00:00         82           71 wb obear       8
5 17 00088cbedd 2012-12-12 05:00:00         83           72 wb obear       6
6 18 00088cbedd 2013-03-25 04:00:00         84           73 wb obear       6
  area observedLength survey pass observedWeight                  comments
1 trib             62  shock    1            1.9 additional genetic sample
2 trib             70  shock    1            3.5                      &lt;NA&gt;
3 trib             74  shock    1            4.8                      &lt;NA&gt;
4 trib             61  shock    1            2.4                      &lt;NA&gt;
5 trib             63  shock    1            2.4                      &lt;NA&gt;
6 trib             67  shock    1            2.3                      &lt;NA&gt;
  cohort species dateEmigrated  sex year season proportionSampled
1   2012     bkt          &lt;NA&gt; &lt;NA&gt; 2013      1                 1
2   2014     bkt          &lt;NA&gt; &lt;NA&gt; 2014      3                 1
3   2014     bkt          &lt;NA&gt; &lt;NA&gt; 2014      4                 1
4   2012     bkt          &lt;NA&gt; &lt;NA&gt; 2012      3                 1
5   2012     bkt          &lt;NA&gt; &lt;NA&gt; 2012      4                 1
6   2012     bkt          &lt;NA&gt; &lt;NA&gt; 2013      1                 1
     lagDetectionDate meanTemperature  meanFlow meanFlowByRiver
1                &lt;NA&gt;              NA        NA              NA
2 2014-12-01 05:00:00        8.551872 0.1334215     0.011314429
3                &lt;NA&gt;              NA        NA              NA
4 2012-12-12 05:00:00        7.854482 0.1188246     0.011209035
5 2013-03-25 04:00:00        1.159617 0.3647114     0.009331247
6                &lt;NA&gt;              NA        NA              NA
  meanFlowByArea_flowExt meanFlowByArea_ByRiver    sdFlow sdFlowByRiver
1                     NA                     NA        NA            NA
2            0.007941757             0.01560029 0.2223856   0.009137988
3                     NA                     NA        NA            NA
4            0.007072896             0.01400050 0.1752469   0.005944621
5            0.021709014             0.01913760 0.4222766   0.004725902
6                     NA                     NA        NA            NA
  sdFlowByArea_flowExt sdFlowByArea_ByRiver propBelowLoFlowThreshByRiver
1                   NA                   NA                           NA
2           0.01323724          0.011931584                    0.1184211
3                   NA                   NA                           NA
4           0.01043136          0.006602405                    0.0000000
5           0.02513551          0.012751383                    0.0000000
6                   NA                   NA                           NA
  propAboveHiFlowThreshByRiver propBelowLoFlowThreshByArea_flowExt
1                           NA                                  NA
2                   0.02631579                          0.19736842
3                           NA                                  NA
4                   0.00000000                          0.07228916
5                   0.00000000                          0.05769231
6                           NA                                  NA
  propAboveHiFlowThreshByArea_flowExt riverOrdered readerId sectionN
1                                  NA     WB OBear       NA        7
2                          0.01315789     WB OBear       NA        3
3                                  NA     WB OBear       NA        3
4                          0.02409639     WB OBear       NA        8
5                          0.05769231     WB OBear       NA        6
6                                  NA     WB OBear       NA        6
  aliveOrDead instance quarter leftOrRight habitat cover justification
1       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
2       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
3       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
4       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
5       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
6       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
  sectionWQuarter  j       date dummy sectionOriginal inside yday ageInSamples
1              NA NA 2013-03-25     1               7   TRUE   84            3
2              NA NA 2014-09-17     1               3   TRUE  260            1
3              NA NA 2014-12-01     1               3   TRUE  335            2
4              NA NA 2012-09-21     1               8   TRUE  265            1
5              NA NA 2012-12-12     1               6   TRUE  347            2
6              NA NA 2013-03-25     1               6   TRUE   84            3
  isYOY lagSection distMoved lagObservedWeight lagObservedLength
1  TRUE         NA        NA                NA                NA
2  TRUE          3         0               4.8                74
3  TRUE         NA        NA                NA                NA
4  TRUE          6         2               2.4                63
5  TRUE          6         0               2.3                67
6  TRUE         NA        NA                NA                NA
  lagSampleNumber sampleNumberDiff      grWeight   grLength minSample maxSample
1              NA               NA            NA         NA        73        73
2              80                1  0.0042090343 0.05330372        79        80
3              NA               NA            NA         NA        79        80
4              72                1  0.0000000000 0.02437786        71        73
5              73                1 -0.0004133674 0.03885067        71        73
6              NA               NA            NA         NA        71        73
  minYear moveDir sampleInterval drainage quarter_length river_meter
1    1997      NA             NA     west           5.00     5251.70
2    1997       0       75.04167     west           4.95     5164.20
3    1997      NA             NA     west           4.95     5164.20
4    1997       1       82.04167     west           5.25     5272.20
5    1997       0      102.95833     west           5.88     5229.95
6    1997      NA             NA     west           5.88     5229.95
  confluence_river_meter riverMeter nPasses  wGR_Slope     grWeightS
1                 5113.7    5251.70       1 -0.3969475            NA
2                 5113.7    5164.20       1 -0.3465367  2.989360e-08
3                 5113.7    5164.20       1 -0.3420982            NA
4                 5113.7    5272.20       1 -0.3465367  0.000000e+00
5                 5113.7    5229.95       1 -0.3420982 -3.572056e-09
6                 5113.7    5229.95       1 -0.3969475            NA
  lw_intercept lw_slope         cf      relCF nPerInd
1    -5.015055  3.02001 0.07972206 0.07340286       1
2    -5.015055  3.02001 0.10204082 0.09372463       2
3    -5.015055  3.02001 0.11845300 0.10867834       2
4    -5.015055  3.02001 0.10573572 0.09738622       3
5    -5.015055  3.02001 0.09598196 0.08834562       3
6    -5.015055  3.02001 0.07647217 0.07030139       3
  meanTemperatureScaledBySeason meanFlowScaledBySeason
1                            NA                     NA
2                    -0.1868645            -0.23138128
3                            NA                     NA
4                    -0.3724716            -0.30228997
5                    -0.9310557            -0.01959074
6                            NA                     NA
  meanFlowByRiverScaledBySeason meanFlowByArea_flowExtScaledBySeason
1                            NA                                   NA
2                     -1.006088                           -0.6701223
3                            NA                                   NA
4                     -1.006669                           -0.6747352
5                     -1.179139                           -1.0864216
6                            NA                                   NA
  meanFlowByArea_ByRiverScaledBySeason meanTemperatureScaledBySeasonRiver
1                                   NA                                 NA
2                           -0.9794098                         -0.1905300
3                                   NA                                 NA
4                           -0.9882194                         -0.3686815
5                           -1.1223501                         -0.9380554
6                                   NA                                 NA
  meanFlowScaledBySeasonRiver meanFlowByRiverScaledBySeasonRiver
1                          NA                                 NA
2                  -0.3921550                         -0.2452333
3                          NA                                 NA
4                  -0.4621895                         -0.2568131
5                  -0.3641220                         -0.9825303
6                          NA                                 NA
  meanFlowByArea_flowExtScaledBySeasonRiver
1                                        NA
2                                -0.4094374
3                                        NA
4                                -0.4776634
5                                -0.3641220
6                                        NA
  meanFlowByArea_ByRiverScaledBySeasonRiver comment sampleType departure
1                                        NA    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
2                                -0.2613931    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
3                                        NA    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
4                                -0.4141903    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
5                                -0.8091726    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
6                                        NA    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
  readerType
1       &lt;NA&gt;
2       &lt;NA&gt;
3       &lt;NA&gt;
4       &lt;NA&gt;
5       &lt;NA&gt;
6       &lt;NA&gt;</code></pre>
</div>
</div>
<p>Break the date observations into month and year so that those variables can be used separately as explanatory variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>obear <span class="ot">&lt;-</span> <span class="fu">separate</span>(obear_All, detectionDate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">'year'</span>, <span class="st">'month'</span>, <span class="st">'day'</span>, <span class="st">'time'</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">one_of</span>(<span class="st">'day'</span>,<span class="st">'time'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 4 pieces. Additional pieces discarded in 18105 rows [1, 2, 3, 4, 5, 6,
7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(obear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X        tag year month sampleName sampleNumber    river section area
1  1 00088cbed0 2013    03         84           73 wb obear       7 trib
2  8 00088cbed7 2014    09         90           79 wb obear       3 trib
3  9 00088cbed7 2014    12         91           80 wb obear       3 trib
4 16 00088cbedd 2012    09         82           71 wb obear       8 trib
5 17 00088cbedd 2012    12         83           72 wb obear       6 trib
6 18 00088cbedd 2013    03         84           73 wb obear       6 trib
  observedLength survey pass observedWeight                  comments cohort
1             62  shock    1            1.9 additional genetic sample   2012
2             70  shock    1            3.5                      &lt;NA&gt;   2014
3             74  shock    1            4.8                      &lt;NA&gt;   2014
4             61  shock    1            2.4                      &lt;NA&gt;   2012
5             63  shock    1            2.4                      &lt;NA&gt;   2012
6             67  shock    1            2.3                      &lt;NA&gt;   2012
  species dateEmigrated  sex season proportionSampled    lagDetectionDate
1     bkt          &lt;NA&gt; &lt;NA&gt;      1                 1                &lt;NA&gt;
2     bkt          &lt;NA&gt; &lt;NA&gt;      3                 1 2014-12-01 05:00:00
3     bkt          &lt;NA&gt; &lt;NA&gt;      4                 1                &lt;NA&gt;
4     bkt          &lt;NA&gt; &lt;NA&gt;      3                 1 2012-12-12 05:00:00
5     bkt          &lt;NA&gt; &lt;NA&gt;      4                 1 2013-03-25 04:00:00
6     bkt          &lt;NA&gt; &lt;NA&gt;      1                 1                &lt;NA&gt;
  meanTemperature  meanFlow meanFlowByRiver meanFlowByArea_flowExt
1              NA        NA              NA                     NA
2        8.551872 0.1334215     0.011314429            0.007941757
3              NA        NA              NA                     NA
4        7.854482 0.1188246     0.011209035            0.007072896
5        1.159617 0.3647114     0.009331247            0.021709014
6              NA        NA              NA                     NA
  meanFlowByArea_ByRiver    sdFlow sdFlowByRiver sdFlowByArea_flowExt
1                     NA        NA            NA                   NA
2             0.01560029 0.2223856   0.009137988           0.01323724
3                     NA        NA            NA                   NA
4             0.01400050 0.1752469   0.005944621           0.01043136
5             0.01913760 0.4222766   0.004725902           0.02513551
6                     NA        NA            NA                   NA
  sdFlowByArea_ByRiver propBelowLoFlowThreshByRiver
1                   NA                           NA
2          0.011931584                    0.1184211
3                   NA                           NA
4          0.006602405                    0.0000000
5          0.012751383                    0.0000000
6                   NA                           NA
  propAboveHiFlowThreshByRiver propBelowLoFlowThreshByArea_flowExt
1                           NA                                  NA
2                   0.02631579                          0.19736842
3                           NA                                  NA
4                   0.00000000                          0.07228916
5                   0.00000000                          0.05769231
6                           NA                                  NA
  propAboveHiFlowThreshByArea_flowExt riverOrdered readerId sectionN
1                                  NA     WB OBear       NA        7
2                          0.01315789     WB OBear       NA        3
3                                  NA     WB OBear       NA        3
4                          0.02409639     WB OBear       NA        8
5                          0.05769231     WB OBear       NA        6
6                                  NA     WB OBear       NA        6
  aliveOrDead instance quarter leftOrRight habitat cover justification
1       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
2       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
3       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
4       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
5       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
6       alive       NA      NA        &lt;NA&gt;      NA    NA          &lt;NA&gt;
  sectionWQuarter  j       date dummy sectionOriginal inside yday ageInSamples
1              NA NA 2013-03-25     1               7   TRUE   84            3
2              NA NA 2014-09-17     1               3   TRUE  260            1
3              NA NA 2014-12-01     1               3   TRUE  335            2
4              NA NA 2012-09-21     1               8   TRUE  265            1
5              NA NA 2012-12-12     1               6   TRUE  347            2
6              NA NA 2013-03-25     1               6   TRUE   84            3
  isYOY lagSection distMoved lagObservedWeight lagObservedLength
1  TRUE         NA        NA                NA                NA
2  TRUE          3         0               4.8                74
3  TRUE         NA        NA                NA                NA
4  TRUE          6         2               2.4                63
5  TRUE          6         0               2.3                67
6  TRUE         NA        NA                NA                NA
  lagSampleNumber sampleNumberDiff      grWeight   grLength minSample maxSample
1              NA               NA            NA         NA        73        73
2              80                1  0.0042090343 0.05330372        79        80
3              NA               NA            NA         NA        79        80
4              72                1  0.0000000000 0.02437786        71        73
5              73                1 -0.0004133674 0.03885067        71        73
6              NA               NA            NA         NA        71        73
  minYear moveDir sampleInterval drainage quarter_length river_meter
1    1997      NA             NA     west           5.00     5251.70
2    1997       0       75.04167     west           4.95     5164.20
3    1997      NA             NA     west           4.95     5164.20
4    1997       1       82.04167     west           5.25     5272.20
5    1997       0      102.95833     west           5.88     5229.95
6    1997      NA             NA     west           5.88     5229.95
  confluence_river_meter riverMeter nPasses  wGR_Slope     grWeightS
1                 5113.7    5251.70       1 -0.3969475            NA
2                 5113.7    5164.20       1 -0.3465367  2.989360e-08
3                 5113.7    5164.20       1 -0.3420982            NA
4                 5113.7    5272.20       1 -0.3465367  0.000000e+00
5                 5113.7    5229.95       1 -0.3420982 -3.572056e-09
6                 5113.7    5229.95       1 -0.3969475            NA
  lw_intercept lw_slope         cf      relCF nPerInd
1    -5.015055  3.02001 0.07972206 0.07340286       1
2    -5.015055  3.02001 0.10204082 0.09372463       2
3    -5.015055  3.02001 0.11845300 0.10867834       2
4    -5.015055  3.02001 0.10573572 0.09738622       3
5    -5.015055  3.02001 0.09598196 0.08834562       3
6    -5.015055  3.02001 0.07647217 0.07030139       3
  meanTemperatureScaledBySeason meanFlowScaledBySeason
1                            NA                     NA
2                    -0.1868645            -0.23138128
3                            NA                     NA
4                    -0.3724716            -0.30228997
5                    -0.9310557            -0.01959074
6                            NA                     NA
  meanFlowByRiverScaledBySeason meanFlowByArea_flowExtScaledBySeason
1                            NA                                   NA
2                     -1.006088                           -0.6701223
3                            NA                                   NA
4                     -1.006669                           -0.6747352
5                     -1.179139                           -1.0864216
6                            NA                                   NA
  meanFlowByArea_ByRiverScaledBySeason meanTemperatureScaledBySeasonRiver
1                                   NA                                 NA
2                           -0.9794098                         -0.1905300
3                                   NA                                 NA
4                           -0.9882194                         -0.3686815
5                           -1.1223501                         -0.9380554
6                                   NA                                 NA
  meanFlowScaledBySeasonRiver meanFlowByRiverScaledBySeasonRiver
1                          NA                                 NA
2                  -0.3921550                         -0.2452333
3                          NA                                 NA
4                  -0.4621895                         -0.2568131
5                  -0.3641220                         -0.9825303
6                          NA                                 NA
  meanFlowByArea_flowExtScaledBySeasonRiver
1                                        NA
2                                -0.4094374
3                                        NA
4                                -0.4776634
5                                -0.3641220
6                                        NA
  meanFlowByArea_ByRiverScaledBySeasonRiver comment sampleType departure
1                                        NA    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
2                                -0.2613931    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
3                                        NA    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
4                                -0.4141903    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
5                                -0.8091726    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
6                                        NA    &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;
  readerType
1       &lt;NA&gt;
2       &lt;NA&gt;
3       &lt;NA&gt;
4       &lt;NA&gt;
5       &lt;NA&gt;
6       &lt;NA&gt;</code></pre>
</div>
</div>
<p>Filter the dataset to include only the relevant explanatory variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>obear <span class="ot">&lt;-</span> obear <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(tag, year, month, river, section, observedLength, observedWeight, meanTemperature, meanFlowByRiver, isYOY, distMoved, moveDir)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(obear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         tag year month    river section observedLength observedWeight
1 00088cbed0 2013    03 wb obear       7             62            1.9
2 00088cbed7 2014    09 wb obear       3             70            3.5
3 00088cbed7 2014    12 wb obear       3             74            4.8
4 00088cbedd 2012    09 wb obear       8             61            2.4
5 00088cbedd 2012    12 wb obear       6             63            2.4
6 00088cbedd 2013    03 wb obear       6             67            2.3
  meanTemperature meanFlowByRiver isYOY distMoved moveDir
1              NA              NA  TRUE        NA      NA
2        8.551872     0.011314429  TRUE         0       0
3              NA              NA  TRUE        NA      NA
4        7.854482     0.011209035  TRUE         2       1
5        1.159617     0.009331247  TRUE         0       0
6              NA              NA  TRUE        NA      NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove NA values</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> obear[<span class="sc">!</span><span class="fu">is.na</span>(obear<span class="sc">$</span>distMoved),]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> sub[<span class="sc">!</span><span class="fu">is.na</span>(sub<span class="sc">$</span>observedLength),]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> sub[<span class="sc">!</span><span class="fu">is.na</span>(sub<span class="sc">$</span>observedWeight),]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         tag year month    river section observedLength observedWeight
2 00088cbed7 2014    09 wb obear       3             70            3.5
4 00088cbedd 2012    09 wb obear       8             61            2.4
5 00088cbedd 2012    12 wb obear       6             63            2.4
7 00088cbee9 2012    09 wb obear       5             70            4.6
8 00088cbee9 2012    12 wb obear       5             80            4.9
9 00088cbee9 2013    03 wb obear       5             86            6.3
  meanTemperature meanFlowByRiver isYOY distMoved moveDir
2        8.551872     0.011314429  TRUE         0       0
4        7.854482     0.011209035  TRUE         2       1
5        1.159617     0.009331247  TRUE         0       0
7        7.912097     0.011192697  TRUE         0       0
8        1.159617     0.009331247  TRUE         0       0
9        8.567922     0.021763704  TRUE         0       0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate adults from YOY</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>sub<span class="sc">$</span>isYOY <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sub<span class="sc">$</span>isYOY)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>adult_all <span class="ot">&lt;-</span> sub[ <span class="fu">which</span>(sub<span class="sc">$</span>isYOY<span class="sc">==</span><span class="st">'FALSE'</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the -90 value</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>adult <span class="ot">&lt;-</span> adult_all[<span class="sc">-</span><span class="fu">which</span>(adult_all<span class="sc">$</span>distMoved<span class="sc">==-</span><span class="dv">90</span>), ]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new distMovedp column that removes negative values</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>distMovedp <span class="ot">&lt;-</span> <span class="fu">abs</span>(adult<span class="sc">$</span>distMoved)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">#rescale explanatory variables</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>observedWeightz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">scale</span>(adult<span class="sc">$</span>observedWeight))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>meanTemperaturez <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">scale</span>(adult<span class="sc">$</span>meanTemperature))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>meanFlowByRiverz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">scale</span>(adult<span class="sc">$</span>meanFlowByRiver))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>observedLengthz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">scale</span>(adult<span class="sc">$</span>observedLength))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn categorical variables into factors</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(adult<span class="sc">$</span>year)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(adult<span class="sc">$</span>month)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>section <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(adult<span class="sc">$</span>section)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>tag <span class="ot">&lt;-</span> <span class="fu">trimws</span>(adult<span class="sc">$</span>tag)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'tag' to a factor to assign unique levels</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>tag_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(adult<span class="sc">$</span>tag)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the factor levels to sequential ID numbers</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>tagID <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(adult<span class="sc">$</span>tag_factor)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>tagID_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(adult<span class="sc">$</span>tagID)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(adult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          tag year month    river section observedLength observedWeight
20 00088cbf13 2013    06 wb obear       4             88            7.4
23 00088cbf21 2013    06 wb obear       4             77            5.9
24 00088cbf21 2013    11 wb obear       4             92            7.7
25 00088cbf21 2014    04 wb obear       4             98            9.9
26 00088cbf21 2014    06 wb obear       4            126           27.1
27 00088cbf21 2014    09 wb obear       4            143           31.6
   meanTemperature meanFlowByRiver isYOY distMoved moveDir distMovedp
20      15.6456620     0.027256256 FALSE         0       0          0
23      13.3230450     0.019279060 FALSE         0       0          0
24       0.9308911     0.004168027 FALSE         0       0          0
25       9.0862017     0.044902085 FALSE         0       0          0
26      15.5165250     0.014811396 FALSE         0       0          0
27       8.5518723     0.011314429 FALSE         0       0          0
   observedWeightz meanTemperaturez meanFlowByRiverz observedLengthz tag_factor
20      -0.6856069        1.1426399        0.9606500      -0.8582898 00088cbf13
23      -0.8299340        0.6920399        0.2023672      -1.3517998 00088cbf21
24      -0.6567414       -1.7121032       -1.2340320      -0.6788316 00088cbf21
25      -0.4450616       -0.1299300        2.6379975      -0.4096443 00088cbf21
26       1.2098899        1.1175866       -0.2223125       0.8465630 00088cbf21
27       1.6428714       -0.2335927       -0.5547213       1.6092603 00088cbf21
   tagID tagID_factor
20     1            1
23     2            2
24     2            2
25     2            2
26     2            2
27     2            2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(adult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     tag                 year         month        river          
 Length:1867        2005   :272   06     :621   Length:1867       
 Class :character   2004   :260   09     :310   Class :character  
 Mode  :character   2003   :245   10     :188   Mode  :character  
                    2010   :231   07     :143                     
                    2013   :201   01     :140                     
                    2002   : 99   04     :139                     
                    (Other):559   (Other):326                     
    section    observedLength  observedWeight  meanTemperature  
 14     :232   Min.   : 58.0   Min.   : 1.90   Min.   : 0.9309  
 15     :176   1st Qu.: 91.0   1st Qu.: 8.00   1st Qu.: 4.9321  
 6      :143   Median :104.0   Median :11.60   Median : 9.6464  
 12     :140   Mean   :107.1   Mean   :14.53   Mean   : 9.7559  
 13     :138   3rd Qu.:119.0   3rd Qu.:17.30   3rd Qu.:14.9830  
 5      :133   Max.   :204.0   Max.   :91.60   Max.   :16.4894  
 (Other):905                                                    
 meanFlowByRiver      isYOY        distMoved          moveDir       
 Min.   :0.002029   FALSE:1867   Min.   :-41.000   Min.   :-1.0000  
 1st Qu.:0.011247   TRUE :   0   1st Qu.: -1.000   1st Qu.:-1.0000  
 Median :0.015362                Median :  0.000   Median : 0.0000  
 Mean   :0.017150                Mean   : -0.692   Mean   :-0.1087  
 3rd Qu.:0.022517                3rd Qu.:  0.000   3rd Qu.: 0.0000  
 Max.   :0.054781                Max.   : 12.000   Max.   : 1.0000  
                                                                    
   distMovedp     observedWeightz   meanTemperaturez   meanFlowByRiverz 
 Min.   : 0.000   Min.   :-1.2148   Min.   :-1.71210   Min.   :-1.4374  
 1st Qu.: 0.000   1st Qu.:-0.6279   1st Qu.:-0.93585   1st Qu.:-0.5611  
 Median : 0.000   Median :-0.2815   Median :-0.02125   Median :-0.1700  
 Mean   : 1.604   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  
 3rd Qu.: 1.000   3rd Qu.: 0.2670   3rd Qu.: 1.01409   3rd Qu.: 0.5101  
 Max.   :41.000   Max.   : 7.4160   Max.   : 1.30632   Max.   : 3.5770  
                                                                        
 observedLengthz        tag_factor       tagID        tagID_factor 
 Min.   :-2.2042   1bf1301e01:  10   Min.   :  1.0   321    :  10  
 1st Qu.:-0.7237   1bf188ba57:   9   1st Qu.:243.5   378    :   9  
 Median :-0.1405   00088cbf21:   8   Median :467.0   2      :   8  
 Mean   : 0.0000   0009f6f571:   8   Mean   :464.4   234    :   8  
 3rd Qu.: 0.5325   00088cfa90:   7   3rd Qu.:673.5   85     :   7  
 Max.   : 4.3460   00088d246a:   7   Max.   :910.0   143    :   7  
                   (Other)   :1818                   (Other):1818  </code></pre>
</div>
</div>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data exploration</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>adult<span class="sc">$</span>non_zero <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(adult<span class="sc">$</span>distMovedp <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairs plot to visualize all data</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>covs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"section"</span>, <span class="st">"observedLengthz"</span>, <span class="st">"observedWeightz"</span>, <span class="st">"meanTemperaturez"</span>, <span class="st">"meanFlowByRiverz"</span>, <span class="st">"non_zero"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(adult[,covs])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(covs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(adult<span class="sc">$</span>non_zero[<span class="fu">which</span>(adult<span class="sc">$</span>non_zero<span class="sc">==</span><span class="dv">0</span>)]) <span class="co"># number of 0's</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 990</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(adult<span class="sc">$</span>non_zero[<span class="fu">which</span>(adult<span class="sc">$</span>non_zero<span class="sc">==</span><span class="dv">1</span>)]) <span class="co"># number of 1's</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 877</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(adult<span class="sc">$</span>non_zero) <span class="co"># proportion of ones (~p)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4697375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(adult<span class="sc">$</span>non_zero, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>), <span class="at">col=</span><span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult, <span class="fu">aes</span>(meanTemperaturez, non_zero)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adult, <span class="fu">aes</span>(meanFlowByRiver, non_zero)) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the frequency of each tag ID</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>tag_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(adult<span class="sc">$</span>tagID_factor)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(tag_counts, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Frequency of Observations by Tag ID"</span>, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Tag ID"</span>, </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"skyblue"</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"black"</span>,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>,  <span class="co"># Rotate x-axis labels vertically for better readability</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.names =</span> <span class="fl">0.6</span>  <span class="co"># Adjust the size of x-axis labels</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the frequency of each section</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>section_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(adult<span class="sc">$</span>section)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(section_counts, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Frequency of Observations by Section"</span>, </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Section"</span>, </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"skyblue"</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"black"</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>,  <span class="co"># Rotate x-axis labels vertically for better readability</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.names =</span> <span class="fl">0.6</span>  <span class="co"># Adjust the size of x-axis labels</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="movers-vs-stayers-model-fitting" class="level2">
<h2 class="anchored" data-anchor-id="movers-vs-stayers-model-fitting">Movers vs Stayers model fitting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">glm</span>(non_zero <span class="sc">~</span> year <span class="sc">+</span> month <span class="sc">+</span> section <span class="sc">+</span> observedLengthz <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span> meanFlowByRiverz, <span class="at">data=</span>adult, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit), <span class="at">na.action =</span> <span class="st">"na.omit"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       GVIF Df GVIF^(1/(2*Df))
year              32.677633 13        1.143511
month            163.764716  9        1.327432
section            1.424987 14        1.012729
observedLengthz   10.719127  1        3.274008
observedWeightz   10.212981  1        3.195776
meanTemperaturez   8.473562  1        2.910938
meanFlowByRiverz   2.062403  1        1.436107</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">glm</span>(non_zero <span class="sc">~</span> meanTemperaturez <span class="sc">+</span> month, <span class="at">data=</span>adult, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit), <span class="at">na.action =</span> <span class="st">"na.omit"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     GVIF Df GVIF^(1/(2*Df))
meanTemperaturez 7.580524  1        2.753275
month            7.580524  9        1.119108</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">glm</span>(non_zero <span class="sc">~</span> observedLengthz <span class="sc">+</span> observedWeightz, <span class="at">data=</span>adult, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit), <span class="at">na.action =</span> <span class="st">"na.omit"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>observedLengthz observedWeightz 
       8.749533        8.749533 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>fitList <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="st">"a.month"</span> <span class="ot">=</span> <span class="fu">glm</span>(non_zero <span class="sc">~</span> year <span class="sc">+</span> month <span class="sc">+</span> section <span class="sc">+</span> observedLengthz <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanFlowByRiverz, <span class="at">data=</span>adult, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit)),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="st">"a.temperature"</span> <span class="ot">=</span> <span class="fu">glm</span>(non_zero <span class="sc">~</span> year <span class="sc">+</span> section <span class="sc">+</span> observedLengthz <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span> meanFlowByRiverz, <span class="at">data=</span>adult, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(fitList)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

               K    AICc Delta_AICc AICcWt Cum.Wt       LL
a.temperature 32 2569.35       0.00   0.84   0.84 -1252.10
a.month       40 2572.67       3.32   0.16   1.00 -1245.44</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>fitList <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="st">"a.length"</span> <span class="ot">=</span> <span class="fu">glm</span>(non_zero <span class="sc">~</span> year <span class="sc">+</span> month <span class="sc">+</span> section <span class="sc">+</span> observedLengthz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span> meanFlowByRiverz, <span class="at">data=</span>adult, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit)),</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="st">"a.weight"</span> <span class="ot">=</span> <span class="fu">glm</span>(non_zero <span class="sc">~</span> year <span class="sc">+</span> month <span class="sc">+</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span> meanFlowByRiverz, <span class="at">data=</span>adult, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(fitList)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

          K    AICc Delta_AICc AICcWt Cum.Wt       LL
a.weight 40 2573.16        0.0   0.57   0.57 -1245.68
a.length 40 2573.76        0.6   0.43   1.00 -1245.98</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">glm</span>(non_zero <span class="sc">~</span> year <span class="sc">+</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span> meanFlowByRiverz, <span class="at">data=</span>adult, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit), <span class="at">na.action =</span> <span class="st">"na.omit"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     GVIF Df GVIF^(1/(2*Df))
year             2.497117 13        1.035824
section          1.293398 14        1.009231
observedWeightz  1.288158  1        1.134970
meanTemperaturez 1.195120  1        1.093215
meanFlowByRiverz 1.569013  1        1.252602</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">glm</span>(non_zero <span class="sc">~</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span> meanFlowByRiverz, <span class="at">data=</span>adult, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit), <span class="at">na.action =</span> <span class="st">"na.omit"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     GVIF Df GVIF^(1/(2*Df))
section          1.052325 14        1.001823
observedWeightz  1.024235  1        1.012045
meanTemperaturez 1.068345  1        1.033608
meanFlowByRiverz 1.053101  1        1.026207</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fitList)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove year due to collinearity - test it with tag later as a nested random effect</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>b.full <span class="ot">&lt;-</span> <span class="fu">glm</span>(non_zero <span class="sc">~</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez<span class="sc">*</span>meanFlowByRiverz, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> adult, <span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dredge</span>(b.full, <span class="at">rank =</span> <span class="st">"AIC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Fixed term is "(Intercept)"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: glm(formula = non_zero ~ section + observedWeightz + meanTemperaturez * 
    meanFlowByRiverz, family = binomial(link = logit), data = adult, 
    na.action = "na.fail")
---
Model selection table 
      (Int)       mFB     mnT     obW sct  mFB:mnT df    logLik    AIC delta
15  0.05846           0.09076 0.07615   +          17 -1264.746 2563.5  0.00
11  0.05525           0.08854           +          16 -1266.028 2564.1  0.56
13  0.10420                   0.07357   +          16 -1266.556 2565.1  1.62
16  0.06019  0.012680 0.09328 0.07533   +          18 -1264.711 2565.4  1.93
9   0.10010                             +          15 -1267.755 2565.5  2.02
12  0.05772  0.017730 0.09209           +          17 -1265.960 2565.9  2.43
32  0.04637  0.019150 0.07632 0.07519   + -0.07674 19 -1264.068 2566.1  2.64
28  0.04383  0.024200 0.07510           + -0.07708 18 -1265.310 2566.6  3.13
14  0.10300 -0.005409         0.07395   +          17 -1266.550 2567.1  3.61
10  0.10000 -0.000244                   +          16 -1267.755 2567.5  4.02
7  -0.12160           0.09744 0.06955               3 -1287.422 2580.8 17.35
3  -0.12150           0.09610                       2 -1288.544 2581.1 17.60
8  -0.12160  0.009496 0.09936 0.06896               4 -1287.402 2582.8 19.31
4  -0.12150  0.013940 0.09894                       3 -1288.500 2583.0 19.51
24 -0.13870  0.016740 0.08085 0.06895     -0.08432  5 -1286.597 2583.2 19.70
5  -0.12130                   0.06771               2 -1289.618 2583.2 19.75
1  -0.12120                                         1 -1290.684 2583.4 19.88
20 -0.13860  0.021190 0.08045             -0.08433  4 -1287.694 2583.4 19.90
6  -0.12130 -0.010550         0.06840               3 -1289.593 2585.2 21.69
2  -0.12120 -0.006056                               2 -1290.676 2585.4 21.86
   weight
15  0.249
11  0.188
13  0.111
16  0.095
9   0.091
12  0.074
32  0.066
28  0.052
14  0.041
10  0.033
7   0.000
3   0.000
8   0.000
4   0.000
24  0.000
5   0.000
1   0.000
20  0.000
6   0.000
2   0.000
Models ranked by AIC(x) </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>b.null <span class="ot">&lt;-</span> <span class="fu">glm</span>(non_zero <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>adult, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>b.top <span class="ot">&lt;-</span> <span class="fu">glm</span>(non_zero <span class="sc">~</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez, <span class="at">data=</span>adult, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>b.glmm <span class="ot">&lt;-</span> <span class="fu">glmer</span>(non_zero <span class="sc">~</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>tagID_factor), <span class="at">data=</span>adult, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit), <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="dv">100000</span>)))</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(b.glmm, b.top, b.null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: adult
Models:
b.null: non_zero ~ 1
b.top: non_zero ~ section + observedWeightz + meanTemperaturez
b.glmm: non_zero ~ section + observedWeightz + meanTemperaturez + (1 | tagID_factor)
       npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
b.null    1 2583.4 2588.9 -1290.7   2581.4                         
b.top    17 2563.5 2657.5 -1264.8   2529.5 51.877 16  1.147e-05 ***
b.glmm   18 2544.5 2644.1 -1254.3   2508.5 20.966  1  4.676e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>b.null <span class="ot">&lt;-</span> <span class="fu">glm</span>(non_zero <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>adult, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>b.top <span class="ot">&lt;-</span> <span class="fu">glm</span>(non_zero <span class="sc">~</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez, <span class="at">data=</span>adult, </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit))</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>b.glmm <span class="ot">&lt;-</span> <span class="fu">glmer</span>(non_zero <span class="sc">~</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>tagID_factor), </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>adult, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit), </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="dv">100000</span>)))</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>b.glmm0 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(non_zero <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>tagID_factor), <span class="at">data=</span>adult, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit), </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="dv">100000</span>)))</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>b.nglmm0 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(non_zero <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>year<span class="sc">/</span>tagID_factor), <span class="at">data=</span>adult, </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="dv">100000</span>)))</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>b.nglmm <span class="ot">&lt;-</span> <span class="fu">glmer</span>(non_zero <span class="sc">~</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span><span class="sc">|</span>year<span class="sc">/</span>tagID_factor),</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>adult, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit), </span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="dv">100000</span>)))</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>b.list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="st">"m0"</span> <span class="ot">=</span> b.null,</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="st">"m1"</span> <span class="ot">=</span> b.top,</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="st">"mm0"</span> <span class="ot">=</span> b.glmm0,</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="st">"mm1"</span> <span class="ot">=</span> b.glmm,</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="st">"nmm0"</span> <span class="ot">=</span> b.nglmm0,</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a><span class="st">"nmm1"</span> <span class="ot">=</span> b.nglmm</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>aic.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">AIC =</span> <span class="fu">sapply</span>(b.list, AIC))</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>aic.table<span class="sc">$</span>Delta.AIC <span class="ot">&lt;-</span> aic.table<span class="sc">$</span>AIC <span class="sc">-</span> <span class="fu">min</span>(aic.table<span class="sc">$</span>AIC)</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>aic.table <span class="ot">&lt;-</span> aic.table[<span class="fu">order</span>(aic.table<span class="sc">$</span>AIC),]</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>aic.table[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          AIC Delta.AIC
mm1  2544.525  0.000000
nmm1 2551.983  7.457721
mm0  2556.893 12.367815
m1   2563.491 18.965726
nmm0 2569.127 24.601578
m0   2583.368 38.842655</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(b.full, b.top, b.glmm, b.nglmm0, b.nglmm, aic.table, b.list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Define the best model based on the above information (that being b.glmm/mm1)</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>b.best <span class="ot">&lt;-</span> <span class="fu">glmer</span>(non_zero <span class="sc">~</span> section <span class="sc">+</span> observedWeightz <span class="sc">+</span> meanTemperaturez <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>tagID_factor), <span class="at">data=</span>adult, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit), <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">optCtrl =</span> <span class="fu">list</span>(<span class="at">maxfun =</span> <span class="dv">100000</span>)))</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(b.best)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: non_zero ~ section + observedWeightz + meanTemperaturez + (1 |  
    tagID_factor)
   Data: adult
Control: glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 1e+05))

     AIC      BIC   logLik deviance df.resid 
  2544.5   2644.1  -1254.3   2508.5     1849 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.6152 -0.8190 -0.6013  0.9103  1.5662 

Random effects:
 Groups       Name        Variance Std.Dev.
 tagID_factor (Intercept) 0.4926   0.7019  
Number of obs: 1867, groups:  tagID_factor, 910

Fixed effects:
                 Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)       0.02331    0.36035   0.065   0.9484  
section2         -0.27164    0.43371  -0.626   0.5311  
section3         -0.59823    0.42782  -1.398   0.1620  
section4          0.04729    0.41442   0.114   0.9091  
section5         -0.13028    0.41275  -0.316   0.7523  
section6         -0.15695    0.40844  -0.384   0.7008  
section7         -0.08409    0.42098  -0.200   0.8417  
section8          0.50251    0.42809   1.174   0.2405  
section9          0.47615    0.43430   1.096   0.2729  
section10         0.38693    0.42864   0.903   0.3667  
section11        -0.14695    0.41383  -0.355   0.7225  
section12        -0.62961    0.41158  -1.530   0.1261  
section13         0.01431    0.41001   0.035   0.9722  
section14        -0.52241    0.39343  -1.328   0.1842  
section15        -0.37484    0.40234  -0.932   0.3515  
observedWeightz   0.07447    0.05477   1.360   0.1739  
meanTemperaturez  0.09486    0.05194   1.826   0.0678 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 17 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate residuals with the top glmm model</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>b.best.simResid <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> b.best, <span class="at">plot =</span> F)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(b.best.simResid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(b.best.simResid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>myroc <span class="ot">&lt;-</span> <span class="fu">roc</span>(adult<span class="sc">$</span>non_zero, <span class="fu">predict</span>(b.best, adult, <span class="at">type =</span> <span class="st">"response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(myroc, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'False-positive rate'</span>, <span class="at">y =</span> <span class="st">'True-positive rate'</span>,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Simulated ROC curve for Best model'</span>) <span class="sc">+</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">5</span>, </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">'AUC: '</span>, <span class="fu">round</span>(<span class="fu">auc</span>(myroc), </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">digits =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>myglmm0roc <span class="ot">&lt;-</span> <span class="fu">roc</span>(adult<span class="sc">$</span>non_zero, <span class="fu">predict</span>(b.glmm0, adult, <span class="at">type =</span> <span class="st">"response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(myglmm0roc, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'False-positive rate'</span>, <span class="at">y =</span> <span class="st">'True-positive rate'</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Simulated ROC curve for Null model with </span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="st">       random effect'</span>) <span class="sc">+</span> </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">5</span>, </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">'AUC: '</span>, <span class="fu">round</span>(<span class="fu">auc</span>(myglmm0roc), </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">digits =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>myglm0roc <span class="ot">&lt;-</span> <span class="fu">roc</span>(adult<span class="sc">$</span>non_zero, <span class="fu">predict</span>(b.null, adult, <span class="at">type =</span> <span class="st">"response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggroc</span>(myglm0roc, <span class="at">legacy.axes =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'False-positive rate'</span>, <span class="at">y =</span> <span class="st">'True-positive rate'</span>,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">'Simulated ROC curve for Null model'</span>) <span class="sc">+</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">'text'</span>, <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">5</span>, </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">'AUC: '</span>, <span class="fu">round</span>(<span class="fu">auc</span>(myglm0roc), </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">digits =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-27-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract unique levels of 'tag' from the original data</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>tag_levels <span class="ot">&lt;-</span> <span class="fu">levels</span>(adult<span class="sc">$</span>tagID_factor)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create df.predict with 'tag' included using the existing levels</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>df.predict <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">meanTemperaturez =</span> <span class="fu">seq</span>(<span class="fu">min</span>(adult<span class="sc">$</span>meanTemperaturez), <span class="fu">max</span>(adult<span class="sc">$</span>meanTemperaturez), <span class="at">length=</span><span class="dv">100</span>),</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">observedWeightz =</span> <span class="fu">mean</span>(adult<span class="sc">$</span>observedWeightz),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">section =</span> <span class="fu">unique</span>(adult<span class="sc">$</span>section),</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tagID_factor =</span> tag_levels  <span class="co"># Include 'tag' using existing levels</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Generate predictions on the response scale</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(b.best, <span class="at">newdata =</span> df.predict, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create a dataframe with predictions and relevant predictor variables</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>df.pred <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df.predict, predictions)</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate confidence intervals </span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a><span class="co"># df.pred$ci.lo &lt;- df.pred$fit - 1.96 * df.pred$se.fit</span></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a><span class="co"># df.pred$ci.hi &lt;- df.pred$fit + 1.96 * df.pred$se.fit</span></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a><span class="co"># unscale our explanatory variables</span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>df.pred<span class="sc">$</span>meanTemperature <span class="ot">&lt;-</span> (df.pred<span class="sc">$</span>meanTemperaturez<span class="sc">*</span><span class="fu">sd</span>(adult<span class="sc">$</span>meanTemperature,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(adult<span class="sc">$</span>meanTemperature,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>df.pred<span class="sc">$</span>observedWeight <span class="ot">&lt;-</span> (df.pred<span class="sc">$</span>observedWeightz<span class="sc">*</span><span class="fu">sd</span>(adult<span class="sc">$</span>observedWeight,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(adult<span class="sc">$</span>observedWeight,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>df.predaverage <span class="ot">&lt;-</span> df.pred <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(meanTemperature, observedWeight, section) <span class="sc">%&gt;%</span> </span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">meanpred =</span> <span class="fu">mean</span>(predictions))</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Plot the predictions</span></span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.predaverage, <span class="fu">aes</span>(<span class="at">x =</span> meanTemperature, <span class="at">y =</span> meanpred, <span class="at">color =</span> section, </span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> section)) <span class="sc">+</span></span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mean Temperature (C)"</span>) <span class="sc">+</span></span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted Probability of Being a Mover"</span>) <span class="sc">+</span></span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract unique levels of 'tag' from the original data</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>tag_levels <span class="ot">&lt;-</span> <span class="fu">levels</span>(adult<span class="sc">$</span>tagID_factor)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create df.predict with 'tag' included using the existing levels</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>df.predict <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">observedWeightz =</span> <span class="fu">seq</span>(<span class="fu">min</span>(adult<span class="sc">$</span>observedWeightz), <span class="fu">max</span>(adult<span class="sc">$</span>observedWeightz), <span class="at">length=</span><span class="dv">100</span>),</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">meanTemperaturez =</span> <span class="fu">mean</span>(adult<span class="sc">$</span>meanTemperaturez),</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">section =</span> <span class="fu">unique</span>(adult<span class="sc">$</span>section),</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tagID_factor =</span> tag_levels  <span class="co"># Include 'tag' using existing levels</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Generate predictions on the response scale</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(b.best, <span class="at">newdata =</span> df.predict, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create a dataframe with predictions and relevant predictor variables</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>df.pred <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df.predict, predictions)</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate confidence intervals </span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a><span class="co"># df.pred$ci.lo &lt;- df.pred$fit - 1.96 * df.pred$se.fit</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="co"># df.pred$ci.hi &lt;- df.pred$fit + 1.96 * df.pred$se.fit</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a><span class="co"># unscale our explanatory variables</span></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>df.pred<span class="sc">$</span>meanTemperature <span class="ot">&lt;-</span> (df.pred<span class="sc">$</span>meanTemperaturez<span class="sc">*</span><span class="fu">sd</span>(adult<span class="sc">$</span>meanTemperature,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(adult<span class="sc">$</span>meanTemperature,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>df.pred<span class="sc">$</span>observedWeight <span class="ot">&lt;-</span> (df.pred<span class="sc">$</span>observedWeightz<span class="sc">*</span><span class="fu">sd</span>(adult<span class="sc">$</span>observedWeight,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(adult<span class="sc">$</span>observedWeight,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>df.predaverage <span class="ot">&lt;-</span> df.pred <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(meanTemperature, observedWeight, section) <span class="sc">%&gt;%</span> </span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">meanpred =</span> <span class="fu">mean</span>(predictions))</span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Plot the predictions</span></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.predaverage, <span class="fu">aes</span>(<span class="at">x =</span> observedWeight, <span class="at">y =</span> meanpred, <span class="at">color =</span> section, <span class="at">fill =</span> section)) <span class="sc">+</span></span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observed Weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted Probability of Being a Mover"</span>) <span class="sc">+</span></span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EcoStats-Final-Project-Code_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>